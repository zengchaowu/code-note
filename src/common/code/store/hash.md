---
title: 哈希
---

哈希的用途很广泛，常用于加密、数据存储等。

## HASH 算法

将任意长度的输入映射成固定长度的输出，这个输出叫做输入的 hash 值。例如对输入的任意内容转成二进制数字以后，与 100 进行取模，这样，一个简陋的 hash 算法就实现了，我们可以将任意输入都映射到[0,99]区间，这个区间就是算法的值域。

上面的方法过于简陋，在实际设计 hash 算法时，需要满足两个条件才能算一个合格的 hash 算法。

1. 一致性：对于同样的输入，总是得到相同的输出；
2. 均匀性：哈希函数的输出尽可能地分布均匀，这样可以尽量避免哈希冲突。

**常见 hash 算法**

1. md5。值域 128 bit
2. sha-1。值域 160 bit
3. sha-256。值域 256 bit

算法输出的值域是确定的，所以 hash 算法主要的区别除了其内部实现效率外，主要是值域的大小。

**hash 冲突**

多个不同输入映射到同一个 hash 值，叫做 hash 冲突，通常使用开放地址法或链表法解决冲突。

1. 开放地址法。它会从当前位置开始，按照一定的规则（如线性探测、二次探测、双重哈希等）依次往后查找，直到找到一个空位置为止。在使用开放地址法时，需要注意选择一个好的探测序列，以避免出现聚集现象，即多个元素被哈希到相邻的位置上，这会导致哈希表的性能下降。
2. 链表法。当发生哈希冲突时，它会在该位置上维护一个链表，将所有哈希值相同的元素都存储在这个链表上。在使用链表法时，需要注意链表长度的控制，当链表过长时，查询效率会下降，需要通过动态调整链表长度或者使用更高级的数据结构（如红黑树）来优化。
3. 建立公共溢出区。当发生冲突时，将发生冲突的元素存储在另一个区域，称为公共溢出区。这种方法适用于表比较大，元素比较少的情况。

## 哈希表

哈希表通常由一个数组和哈希桶组成。数组是存放哈希桶的数组，每个哈希桶都是一个链表，用于存储键值对。

具体来说，哈希表内部通常有以下几个部分：

- 数组：通常是固定大小的连续空间，存放指向哈希桶的指针。
- 哈希桶：每个哈希桶是一个链表，用于存储键值对。
- 键值对：存储数据的基本单位，包括键和值。
- 哈希函数：用于将键映射到数组下标，使得数据能够快速定位到哈希桶。

以链表法为例，在将数据插入哈希表时，首先根据哈希函数计算出键对应的哈希桶，然后将键值对插入到该哈希桶的链表中。当需要查找数据时，根据哈希函数计算出键对应的哈希桶，然后遍历该哈希桶的链表，找到对应的键值对。由于哈希表的底层数据结构是数组和链表，因此支持随机访问和顺序访问，可以高效地实现插入、查找和删除操作。

**拓容**

哈希表的拓容指的是在哈希表内元素数量达到一定阈值时，将哈希表的容量扩大并重新散列元素，以保证哈希表的性能，其基本思想与可变数组相同。不同语言对此阈值计算可能不同，在 java 中根据负载因子判断是否进行扩容，默认为 0.75.

## Map 与 Set

**Map 与哈希表**

我们常常会将 Map 与哈希表画上等号，因为大部分语言中 Map 都是通过哈希表实现的。但是 Map 应该是一种抽象概念，一个能够提供 key-value 形式访问的接口。其底层实现上并不一定要使用哈希表，也可以使用二叉树等其他数据结构。

**有序还是无序**

如果底层使用的是 hash 表，map 通常是无序的，也就是说在内存结构上，后面插入的数据可能存储在前面。

**Set**

Set 与 Map 一样，是一个高级概念，不同语言可能有不同的实现方式。例如在 java 中 set 通过哈希表实现，在 c++中则通过高度平衡二叉搜索树 AVL 实现。

**Map 与 Dictionary**

**编程语言中使用的 hash**

编程语言中使用的 hash 算法通常由其自己实现，而不会使用上面所说的常用算法。
